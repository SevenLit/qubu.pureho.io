!function(){var t={submitFlag:!1,username:"",passwd:"",verify_passwd:"",nick_name:"",sex:"",phone:"",captcha:"",email:"",address:"",init:function(){t.bindEvent()},bindEvent:function(){$("input[name='sex']").click(function(){var e=$(this).val();$("#sex_val").val(e)}),$("#captcha_img").click(function(){var e=$(this),t=gppTool.randomNum(10);e.attr("src","../common/captcha?"+t)}),$("#username").bind("input propertychange",function(){var e=$("#username").val();""===$.trim(e)?$("#name_prompt").empty():4<=e.length&&e.length<=32?$("#name_prompt").empty():$("#name_prompt").text("* 用户名长度4-32个字符")}),$("#passwd").bind("input propertychange",function(){var e=$("#passwd").val();""===$.trim(e)?$("#passwd_prompt").empty():6<=e.length&&e.length<=32?$("#passwd_prompt").empty():$("#passwd_prompt").text("* 密码长度6-32个字符")}),$("#repeat_passwd").bind("input propertychange",function(){var e=$("#passwd").val(),t=$("#repeat_passwd").val();""===$.trim(t)?$("#repeatpw_prompt").empty():e.length!==t.length||e!==t?$("#repeatpw_prompt").text("* 两次输入的密码不一致"):$("#repeatpw_prompt").empty()}),$("#phone").bind("input propertychange",function(){var e=$("#phone").val();""===$.trim(e)&&$("#phone_prompt").empty(),0===gppTool.isPhoneNum(e)||4===gppTool.isPhoneNum(e)||11!==e.length?$("#phone_prompt").text("* 请输入正确的手机号码"):$("#phone_prompt").empty()}),$("#captcha").bind("input propertychange",function(){var e=$("#captcha").val();""!==$.trim(e)&&4!==e.length||$("#captcha_prompt").empty()}),$("#email").bind("input propertychange",function(){var e=$("#email").val();""===$.trim(e)?($("#email_prompt").empty(),$("#email").removeClass("bd-red")):/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(e)?($("#email_prompt").empty(),$("#email").removeClass("bd-red")):($("#email_prompt").text("* 请输入正确的邮箱"),$("#email").addClass("bd-red"))}),$("#sub").click(function(){return t.checkForm()&&t.submitForm(),!1}),$("#signup_form").submit(function(){return t.checkForm()&&t.submitForm(),!1})},checkForm:function(){return t.username=$("#username").val(),t.passwd=$("#passwd").val(),t.repeat_passwd=$("#repeat_passwd").val(),t.nick_name=$("#nick_name").val(),t.sex=$("#sex_val").val(),t.phone=$("#phone").val(),t.captcha=$("#captcha").val(),t.email=$("#email").val(),t.address=$("#address").val(),""===$.trim(t.username)?($("#name_prompt").text("* 请输入用户名"),$("#username").focus(),!1):t.username.length<4||32<t.username.length?($("#name_prompt").text("* 用户名长度4-32个字符"),$("#username").focus(),!1):""===$.trim(t.passwd)?($("#passwd_prompt").text("* 请输入密码"),$("#passwd").focus(),!1):t.passwd.length<6||32<t.passwd.length?($("#passwd_prompt").text("* 密码长度6-32个字符"),$("#passwd").focus(),!1):""===$.trim(t.repeat_passwd)?($("#repeatpw_prompt").text("* 请再次输入密码"),$("#repeat_passwd").focus(),!1):t.passwd!==t.repeat_passwd?($("#passwd_prompt").text("* 两次输入的密码不一致"),$("#repeatpw_prompt").text("* 两次输入的密码不一致"),$("#repeat_passwd").focus(),!1):0===gppTool.isPhoneNum(t.phone)||4===gppTool.isPhoneNum(t.phone)?($("#phone_prompt").text("* 请输入正确的手机号码"),$("#phone").focus(),!1):""===$.trim(t.captcha)||4!==t.captcha.length?($("#captcha_prompt").text("* 验证码不正确"),$("#captcha").focus(),!1):""===$.trim(t.email)?($("#email_prompt").text("* 请输入邮箱"),$("#email").focus(),!1):!!/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(t.email)||($("#email_prompt").text("* 请输入正确的邮箱"),$("#email").focus(),!1)},submitForm:function(){return!!t.checkForm()&&(!0!==t.submitFlag&&(t.submitFlag=!0,void $.ajax({url:"/member/signup",type:"POST",dataType:"json",async:!0,data:{user_name:t.username,user_pw:$.md5(t.passwd),nick_name:t.nick_name,user_phone:t.phone,user_sex:t.sex,user_email:t.email,user_address:t.address,captcha:t.captcha},success:function(e){return t.submitFlag=!1,-1===e.code?($("#captcha_prompt").text("* 验证码不正确"),$("#captcha").focus(),!1):0===e.code?(alert(e.msg),!1):2===e.code?($("#name_prompt").text("* 用户名已注册"),$("#username").focus(),!1):3===e.code?($("#phone_prompt").text("* 手机号码已存在"),$("#phone").focus(),!1):4===e.code?($("#email_prompt").text("* 邮箱已存在"),$("#email").focus(),!1):(alert(e.msg),void(window.location="/member/login"))}})))}};window.pageScript=new t.init}();